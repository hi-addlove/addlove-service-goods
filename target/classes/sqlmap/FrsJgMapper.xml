<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.addlove.service.goods.dao.FrsJgDao">
  <resultMap id="BaseResultMap" type="com.addlove.service.goods.model.FrsJgHeadModel">
    <result column="BILLNO" jdbcType="VARCHAR" property="billNo" />
    <result column="LRDATE" jdbcType="TIMESTAMP" property="lrDate" />
    <result column="USERID" jdbcType="NUMERIC" property="userId" />
    <result column="USERCODE" jdbcType="VARCHAR" property="userCode" />
    <result column="USERNAME" jdbcType="VARCHAR" property="userName" />
    <result column="JZDATE" jdbcType="DATE" property="jzDate" />
    <result column="JZRID" jdbcType="NUMERIC" property="jzrId" />
    <result column="JZRCODE" jdbcType="VARCHAR" property="jzrCode" />
    <result column="JZRNAME" jdbcType="VARCHAR" property="jzrName" />
    <result column="JZTYPE" jdbcType="VARCHAR" property="jzType" />
    <result column="RPTDATE" jdbcType="VARCHAR" property="rptDate" />
    <result column="PRNTIMES" jdbcType="NUMERIC" property="prnTimes" />
    <result column="PRNDATE" jdbcType="DATE" property="prnDate" />
    <result column="TIMEMARK" jdbcType="NUMERIC" property="timeMark" />
    <result column="YWTYPE" jdbcType="VARCHAR" property="ywType" />
    <result column="YWIOTYPE" jdbcType="VARCHAR" property="ywIoType" />
    <result column="ZDRID" jdbcType="NUMERIC" property="zdrId" />
    <result column="ZDRCODE" jdbcType="VARCHAR" property="zdrCode" />
    <result column="ZDRNAME" jdbcType="VARCHAR" property="zdrName" />
    <result column="ORGCODE" jdbcType="VARCHAR" property="orgCode" />
    <result column="ORGNAME" jdbcType="VARCHAR" property="orgName" />
   <result column="DEPID" jdbcType="NUMERIC" property="depId" />
    <result column="DEPCODE" jdbcType="VARCHAR" property="depCode" />
    <result column="DEPNAME" jdbcType="VARCHAR" property="depName" />
    <result column="GYCODE" jdbcType="VARCHAR" property="gyCode" />
    <result column="GYNAME" jdbcType="VARCHAR" property="gyName" />
    <result column="YLCOUNT" jdbcType="NUMERIC" property="ylCount" />
    <result column="YLHCOST" jdbcType="NUMERIC" property="ylhCost" />
    <result column="YLWCOST" jdbcType="NUMERIC" property="ylwCost" />
    <result column="YLTOTAL" jdbcType="NUMERIC" property="ylTotal" />
    <result column="CPCOUNT" jdbcType="NUMERIC" property="cpCount" />
    <result column="CPHCOST" jdbcType="NUMERIC" property="cphCost" />
    <result column="CPWCOST" jdbcType="NUMERIC" property="cpwCost" />
    <result column="CPTOTAL" jdbcType="NUMERIC" property="cpTotal" />
    <result column="FLCOST" jdbcType="NUMERIC" property="flCost" />
    <result column="REMARK" jdbcType="VARCHAR" property="remark" />
    <result column="DATASTATUS" jdbcType="VARCHAR" property="dataStatus" />
    <result column="REFBILLTYPE" jdbcType="VARCHAR" property="refBillType" />
    <result column="REFBILLNO" jdbcType="VARCHAR" property="refBillNo" />
    <result column="CKCODE" jdbcType="VARCHAR" property="ckCode" />
    <result column="CKNAME" jdbcType="VARCHAR" property="ckName" />
  </resultMap>
  
  <resultMap id="BaseResultMapYl" type="com.addlove.service.goods.model.FrsJgYlModel">
    <result column="BILLNO" jdbcType="VARCHAR" property="billNo" />
    <result column="SERIALNO" jdbcType="NUMERIC" property="serialNo" />
    <result column="PLUID" jdbcType="NUMERIC" property="pluId" />
    <result column="PLUCODE" jdbcType="VARCHAR" property="pluCode" />
    <result column="PLUNAME" jdbcType="VARCHAR" property="pluName" />
    <result column="BARCODE" jdbcType="VARCHAR" property="barCode" />
    <result column="SPEC" jdbcType="VARCHAR" property="spec" />
    <result column="UNIT" jdbcType="VARCHAR" property="unit" />
    <result column="EXPLUCODE" jdbcType="VARCHAR" property="exPluCode" />
    <result column="EXPLUNAME" jdbcType="VARCHAR" property="exPluName" />
    <result column="HJPRICE" jdbcType="NUMERIC" property="hjPrice" />
    <result column="WJPRICE" jdbcType="NUMERIC" property="wjPrice" />
    <result column="PRICE" jdbcType="NUMERIC" property="price" />
    <result column="JTAXRATE" jdbcType="NUMERIC" property="jTaxRate" />
    <result column="YLPERCENT" jdbcType="NUMERIC" property="ylPercent" />
    <result column="YLCOUNT" jdbcType="NUMERIC" property="ylCount" />
    <result column="YLHCOST" jdbcType="NUMERIC" property="ylhCost" />
    <result column="YLWCOST" jdbcType="NUMERIC" property="ylwCost" />
    <result column="YLTOTAL" jdbcType="NUMERIC" property="ylTotal" />
    <result column="REMARK" jdbcType="VARCHAR" property="remark" />
    <result column="JTAXCALTYPE" jdbcType="VARCHAR" property="jTaxcalType" />
  </resultMap>
  
  <resultMap id="BaseResultMapCp" type="com.addlove.service.goods.model.FrsJgCpModel">
    <result column="BILLNO" jdbcType="VARCHAR" property="billNo" />
    <result column="SERIALNO" jdbcType="NUMERIC" property="serialNo" />
    <result column="PLUID" jdbcType="NUMERIC" property="pluId" />
    <result column="PLUCODE" jdbcType="VARCHAR" property="pluCode" />
    <result column="PLUNAME" jdbcType="VARCHAR" property="pluName" />
    <result column="BARCODE" jdbcType="VARCHAR" property="barCode" />
    <result column="SPEC" jdbcType="VARCHAR" property="spec" />
    <result column="UNIT" jdbcType="VARCHAR" property="unit" />
    <result column="EXPLUCODE" jdbcType="VARCHAR" property="exPluCode" />
    <result column="EXPLUNAME" jdbcType="VARCHAR" property="exPluName" />
    <result column="HJPRICE" jdbcType="NUMERIC" property="hjPrice" />
    <result column="WJPRICE" jdbcType="NUMERIC" property="wjPrice" />
    <result column="PRICE" jdbcType="NUMERIC" property="price" />
    <result column="JTAXRATE" jdbcType="NUMERIC" property="jTaxRate" />
    <result column="CPPERCENT" jdbcType="NUMERIC" property="cpPercent" />
    <result column="CPCOUNT" jdbcType="NUMERIC" property="cpCount" />
    <result column="CPHCOST" jdbcType="NUMERIC" property="cphCost" />
    <result column="CPWCOST" jdbcType="NUMERIC" property="cpwCost" />
    <result column="CPTOTAL" jdbcType="NUMERIC" property="cpTotal" />
    <result column="REMARK" jdbcType="VARCHAR" property="remark" />
    <result column="JTAXCALTYPE" jdbcType="VARCHAR" property="jTaxcalType" />
    <result column="FPPERCENT" jdbcType="NUMERIC" property="fpPercent" />
  </resultMap>
  
   <resultMap id="BaseResultMapGy" type="com.addlove.service.goods.model.FrsGyModel">
    <id column="GYCODE" jdbcType="VARCHAR" property="gyCode" />
    <result column="GYNAME" jdbcType="VARCHAR" property="gyName" />
    <result column="ORGCODE" jdbcType="VARCHAR" property="orgCode" />
    <result column="ORGCNAME" jdbcType="VARCHAR" property="orgcName" />
    <result column="DEPTID" jdbcType="VARCHAR" property="deptId" />
    <result column="DEPCODE" jdbcType="VARCHAR" property="depCode" />
    <result column="DEPNAME" jdbcType="VARCHAR" property="depName" />
    <result column="FLCOST" jdbcType="NUMERIC" property="flCost" />
    <result column="REMARK" jdbcType="VARCHAR" property="remark" />
    <result column="USESTATUS" jdbcType="VARCHAR" property="useStatus" />
  </resultMap>
  
  <resultMap id="BaseResultMapSkuO" type="com.addlove.service.goods.model.SkuLyBsSetOrgModel" >
    <result column="PROCODE" property="proCode" jdbcType="VARCHAR" />
    <result column="SERIALNO" property="serialNo" jdbcType="NUMERIC" />
    <result column="USORGCODE" property="usOrgCode" jdbcType="VARCHAR" />
    <result column="USORGNAME" property="usOrgName" jdbcType="VARCHAR" />
    <result column="REMARK" property="remark" jdbcType="VARCHAR" />
  </resultMap>
  
   <resultMap id="BaseResultMapSkuH" type="com.addlove.service.goods.model.SkuLyBsSetHeadModel" >
    <result column="PROCODE" property="proCode" jdbcType="VARCHAR" />
    <result column="CTRLTYPE" property="ctrlType" jdbcType="VARCHAR" />
    <result column="CTRLTYPEEX" property="ctrlTypeEx" jdbcType="VARCHAR" />
    <result column="PRONAME" property="proName" jdbcType="VARCHAR" />
    <result column="LRDATE" jdbcType="TIMESTAMP" property="lrDate" />
    <result column="USERID" jdbcType="NUMERIC" property="userId" />
    <result column="USERCODE" jdbcType="VARCHAR" property="userCode" />
    <result column="USERNAME" jdbcType="VARCHAR" property="userName" />
    <result column="CTRLTYPEEXNAME" property="ctrlTypeExName" jdbcType="VARCHAR" />
    <result column="REMARK" property="remark" jdbcType="VARCHAR" />
    <result column="TIMEMARK" property="timemark" jdbcType="NUMERIC" />
  </resultMap>
  
  <resultMap id="BaseResultMapSkuB" type="com.addlove.service.goods.model.SkuLyBsSetBodyModel" >
    <result column="PROCODE" property="proCode" jdbcType="VARCHAR" />
    <result column="SERIALNO" jdbcType="NUMERIC" property="serialNo" />
    <result column="PLUID" jdbcType="NUMERIC" property="pluId" />
    <result column="PLUCODE" jdbcType="VARCHAR" property="pluCode" />
    <result column="PLUNAME" jdbcType="VARCHAR" property="pluName" />
    <result column="REMARK" property="remark" jdbcType="VARCHAR" />
  </resultMap>
  
  <resultMap id="BaseResultMapSkuEx" type="com.addlove.service.goods.model.SkuPluExtendModel">
    <result column="PLUID" jdbcType="NUMERIC" property="pluId" />
    <result column="PLUCODE" jdbcType="VARCHAR" property="pluCode" />
    <result column="PLUNAME" jdbcType="VARCHAR" property="pluName" />
    <result column="PLUENAME" jdbcType="VARCHAR" property="pluEName" />
    <result column="PLUABBRNAME" jdbcType="VARCHAR" property="pluAbbrName" />
    <result column="PLUMN" jdbcType="VARCHAR" property="plumn" />
    <result column="BARCODE" jdbcType="VARCHAR" property="barCode" />
    <result column="UNIT" jdbcType="VARCHAR" property="unit" />
    <result column="SPEC" jdbcType="VARCHAR" property="spec" />
    <result column="PLUWEIGHT" jdbcType="NUMERIC" property="pluWeight" />
    <result column="PLUHEIGHT" jdbcType="NUMERIC" property="pluHeight" />
    <result column="PLULONG" jdbcType="NUMERIC" property="pluLong" />
    <result column="PLUWIDTH" jdbcType="NUMERIC" property="pluWidth" />
    <result column="ISMULPACKET" jdbcType="VARCHAR" property="isMulPacket" />
    <result column="ORGCODE" jdbcType="VARCHAR" property="orgCode" />
    <result column="ORGNAME" jdbcType="VARCHAR" property="orgName" />
    <result column="CGYID" jdbcType="NUMERIC" property="cgyId" />
    <result column="CGYCODE" jdbcType="VARCHAR" property="cgyCode" />
    <result column="CGYNAME" jdbcType="VARCHAR" property="cgyName" />
    <result column="CARGONO" jdbcType="VARCHAR" property="carGoNo" />
    <result column="PRODUCE" jdbcType="VARCHAR" property="produce" />
    <result column="GRADE" jdbcType="VARCHAR" property="grade" />
    <result column="QUALITY" jdbcType="VARCHAR" property="quality" />
    <result column="ISSEASON" jdbcType="VARCHAR" property="isSeason" />
    <result column="SALESEASON" jdbcType="VARCHAR" property="saleSeason" />
    <result column="BZDAYS" jdbcType="NUMERIC" property="bzDays" />
    <result column="CLSID" jdbcType="NUMERIC" property="clsId" />
    <result column="BRANDCODE" jdbcType="VARCHAR" property="brandCode" />
    <result column="JTAXCALTYPE" jdbcType="VARCHAR" property="jTaxCalType" />
    <result column="WJPRICE" jdbcType="NUMERIC" property="wjPrice" />
    <result column="HJPRICE" jdbcType="NUMERIC" property="hjPrice" />
    <result column="JTAXRATE" jdbcType="NUMERIC" property="jTaxRate" />
    <result column="PRICE" jdbcType="NUMERIC" property="price" />
    <result column="XTAXRATE" jdbcType="NUMERIC" property="xTaxRate" />
    <result column="PROMDECIMAL" jdbcType="NUMERIC" property="promDecimal" />
    <result column="PROMFORMULA" jdbcType="VARCHAR" property="promFormula" />
    <result column="DOTDECIMAL" jdbcType="NUMERIC" property="dotDecimal" />
    <result column="ISWEIGHT" jdbcType="VARCHAR" property="isWeight" />
    <result column="ISCOUTQTY" jdbcType="VARCHAR" property="isCoutQty" />
    <result column="ISSELFBRAND" jdbcType="VARCHAR" property="isSelfBrand" />
    <result column="ISKC" jdbcType="VARCHAR" property="isKc" />
    <result column="ISFRESH" jdbcType="VARCHAR" property="isFresh" />
    <result column="ISEXPLUCODE" jdbcType="VARCHAR" property="isExPluCode" />
    <result column="ISCURRDAY" jdbcType="VARCHAR" property="isCurrDay" />
    <result column="JHBFBZDAYS" jdbcType="NUMERIC" property="jhBfBzDays" />
    <result column="PSBFBZDAYS" jdbcType="NUMERIC" property="psBfBzDays" />
    <result column="ISNEWPLU" jdbcType="VARCHAR" property="isNewPlu" />
    <result column="ISACTIVE" jdbcType="VARCHAR" property="isActive" />
    <result column="CXINFO" jdbcType="VARCHAR" property="cxInfo" />
    <result column="YWSTATUS" jdbcType="VARCHAR" property="ywStatus" />
    <result column="LRDATE" jdbcType="VARCHAR" property="lrDate" />
    <result column="LRUSERID" jdbcType="NUMERIC" property="lrUserId" />
    <result column="LRUSERCODE" jdbcType="VARCHAR" property="lrUserCode" />
    <result column="LRUSERNAME" jdbcType="VARCHAR" property="lrUserName" />
    <result column="ZXDATE" jdbcType="VARCHAR" property="zxDate" />
    <result column="ZXUSERID" jdbcType="NUMERIC" property="zxUserId" />
    <result column="ZXUSERCODE" jdbcType="VARCHAR" property="zxUserCode" />
    <result column="ZXUSERNAME" jdbcType="VARCHAR" property="zxUserName" />
    <result column="UDP1" jdbcType="VARCHAR" property="udp1" />
    <result column="UDP2" jdbcType="VARCHAR" property="udp2" />
    <result column="UDP3" jdbcType="VARCHAR" property="udp3" />
    <result column="UDP4" jdbcType="VARCHAR" property="udp4" />
    <result column="UDP5" jdbcType="VARCHAR" property="udp5" />
    <result column="UDP6" jdbcType="VARCHAR" property="udp6" />
    <result column="UDP7" jdbcType="VARCHAR" property="udp7" />
    <result column="UDP8" jdbcType="VARCHAR" property="udp8" />
    <result column="UDP9" jdbcType="VARCHAR" property="udp9" />
    <result column="DATASTATUS" jdbcType="VARCHAR" property="dataStatus" />
    <result column="HYPRICE" jdbcType="NUMERIC" property="hyPrice" />
    <result column="PLUCLS" jdbcType="VARCHAR" property="pluCls" />
    <result column="PLUMODEL" jdbcType="VARCHAR" property="pluModel" />
    <result column="UDP10" jdbcType="VARCHAR" property="udp10" />
    <result column="UDP11" jdbcType="VARCHAR" property="udp11" />
    <result column="UDP12" jdbcType="VARCHAR" property="udp12" />
    <result column="UDP13" jdbcType="VARCHAR" property="udp13" />
    <result column="UDP14" jdbcType="VARCHAR" property="udp14" />
    <result column="MATERIALCODE" jdbcType="VARCHAR" property="materialCode" />
    <result column="LRORGCODE" jdbcType="VARCHAR" property="lrOrgCode" />
    <result column="LRORGNAME" jdbcType="VARCHAR" property="lrOrgName" />
    <result column="DATASRC" jdbcType="VARCHAR" property="dataSrc" />
    <result column="MINTHDAYS" jdbcType="NUMERIC" property="minThDays" />
    <result column="MAXTHDAYS" jdbcType="NUMERIC" property="maxThDays" />
    <result column="ISONLINE" jdbcType="VARCHAR" property="isOnline" />
    <result column="LINEDATE" jdbcType="VARCHAR" property="lineDate" />
    <result column="PLUDESC" jdbcType="VARCHAR" property="pluDesc" />
    <result column="EXPLUCODE" jdbcType="VARCHAR" property="exPluCode" />
    <result column="KCCOUNT" jdbcType="VARCHAR" property="kcCount" />
    <result column="HCOST" jdbcType="VARCHAR" property="hCost" />
    <result column="WCOST" jdbcType="VARCHAR" property="wCost" />
    <result column="PLUTYPE" jdbcType="VARCHAR" property="pluType" />
    <result column="PACKQTY" jdbcType="VARCHAR" property="packQty" />
  </resultMap>
  
  <sql id="Base_Column_List">
    BILLNO, LRDATE, USERID, USERCODE, USERNAME, JZDATE, JZRID, JZRCODE, JZRNAME, JZTYPE, 
    RPTDATE, PRNTIMES, PRNDATE, TIMEMARK, YWTYPE, YWIOTYPE, ZDRID, ZDRCODE, ZDRNAME, 
    ORGCODE, ORGNAME, DEPID, DEPCODE, DEPNAME, GYCODE, GYNAME, YLCOUNT, YLHCOST, YLWCOST, 
    YLTOTAL, CPCOUNT, CPHCOST, CPWCOST, CPTOTAL, FLCOST, REMARK, DATASTATUS, REFBILLTYPE, 
    REFBILLNO, CKCODE, CKNAME
  </sql>
  
  <sql id="Base_Column_List_Yl">
    BILLNO, SERIALNO, PLUID, PLUCODE, PLUNAME, BARCODE, SPEC, UNIT, EXPLUCODE, EXPLUNAME, 
    HJPRICE, WJPRICE, PRICE, JTAXRATE, YLPERCENT, YLCOUNT, YLHCOST, YLWCOST, YLTOTAL, 
    REMARK, JTAXCALTYPE
  </sql>
  
  <sql id="Base_Column_List_Cp">
    BILLNO, SERIALNO, PLUID, PLUCODE, PLUNAME, BARCODE, SPEC, UNIT, EXPLUCODE, EXPLUNAME, 
    HJPRICE, WJPRICE, PRICE, JTAXRATE, CPPERCENT, CPCOUNT, CPHCOST, CPWCOST, CPTOTAL, 
    REMARK, JTAXCALTYPE, FPPERCENT
  </sql>
  
  <!-- 查询加工单列表 -->
  <select id="queryJgPage" resultMap="BaseResultMap">
    Select Distinct t.BILLNO,
                t.USERID,
                t.USERCODE,
                t.USERNAME,
                t.JZDATE,
                t.JZRID,
                t.JZRCODE,
                t.JZRNAME,
                t.YWTYPE,
                t.YWIOTYPE,
                t.ORGCODE,
                t.ORGNAME,
                t.DEPID,
                t.DEPCODE,
                t.DEPNAME,
                t.GYCODE, 
                t.GYNAME, 
                t.YLCOUNT, 
                t.YLHCOST, 
                t.YLWCOST, 
                t.YLTOTAL, 
                t.CPCOUNT, 
                t.CPHCOST, 
                t.CPWCOST, 
                t.CPTOTAL, 
                t.FLCOST, 
                t.REMARK, 
                t.DATASTATUS,
                t.CKCODE, 
                t.CKNAME
    From TFRSJGHEAD t Where t.YWTYPE = '1401'
    <if test="queryModel.billNo != '' and queryModel.billNo != null">
        and t.BILLNO LIKE CONCAT(#{queryModel.billNo,jdbcType=VARCHAR},'%')
    </if>
    <if test="queryModel.startDate != '' and queryModel.startDate != null">
        and t.LRDATE &gt;= to_date(#{queryModel.startDate,jdbcType=VARCHAR},'yyyy-MM-dd HH24:mi:ss')
    </if>
    <if test="queryModel.endDate != '' and queryModel.endDate != null">
        and t.LRDATE &lt;= to_date(#{queryModel.endDate,jdbcType=VARCHAR},'yyyy-MM-dd HH24:mi:ss')
    </if>
    <if test="queryModel.depId != null ">
        and t.DEPID = #{queryModel.depId,jdbcType=VARCHAR}
    </if>
    <if test="queryModel.dataStatus != null and queryModel.dataStatus != '' ">
        and t.DATASTATUS = #{queryModel.dataStatus,jdbcType=VARCHAR}
    </if>
    and t.ORGCODE = #{queryModel.orgCode,jdbcType=VARCHAR}
  </select>
  
  <!-- 插入加工单主表 -->
  <insert id="insertJgHead">
    INSERT INTO TFRSJGHEAD
    (
        BILLNO,
        LRDATE, 
        USERID, 
        USERCODE, 
        USERNAME,
        YWTYPE, 
        YWIOTYPE, 
        ORGCODE, 
        ORGNAME, 
        DEPID, 
        DEPCODE, 
        DEPNAME, 
        GYCODE, 
        GYNAME, 
        YLCOUNT, 
        YLHCOST, 
        YLWCOST, 
        YLTOTAL, 
        CPCOUNT, 
        CPHCOST, 
        CPWCOST, 
        CPTOTAL, 
        FLCOST, 
        REMARK, 
        DATASTATUS,
        CKCODE, 
        CKNAME
    )
    VALUES
    (
        #{billNo,jdbcType=VARCHAR},
        to_date(#{lrDate,jdbcType=DATE},'yyyy-MM-dd HH24:mi:ss'),
        #{userId,jdbcType=NUMERIC},
        #{userCode,jdbcType=VARCHAR},
        #{userName,jdbcType=VARCHAR},
        #{ywType,jdbcType=VARCHAR},
        #{ywIoType,jdbcType=VARCHAR},
        #{orgCode,jdbcType=VARCHAR},
        #{orgName,jdbcType=VARCHAR},
        #{depId,jdbcType=NUMERIC},
        #{depCode,jdbcType=VARCHAR},
        #{depName,jdbcType=VARCHAR},
        #{gyCode,jdbcType=VARCHAR},
        #{gyName,jdbcType=VARCHAR},
        #{ylCount,jdbcType=NUMERIC},
        #{ylhCost,jdbcType=NUMERIC},
        #{ylwCost,jdbcType=NUMERIC},
        #{ylTotal,jdbcType=NUMERIC},
        #{cpCount,jdbcType=NUMERIC},
        #{cphCost,jdbcType=NUMERIC},
        #{cpwCost,jdbcType=NUMERIC},
        #{cpTotal,jdbcType=NUMERIC},
        #{flCost,jdbcType=NUMERIC},
        #{remark,jdbcType=VARCHAR},
        #{dataStatus,jdbcType=VARCHAR},
        #{ckCode,jdbcType=VARCHAR},
        #{ckName,jdbcType=VARCHAR}
    )
  </insert>
  
  <!-- 插入原料数据 -->
  <insert id="insertJgYls">
    INSERT INTO TFRSJGYL
    (
        BILLNO, 
        SERIALNO, 
        PLUID, 
        PLUCODE, 
        PLUNAME, 
        BARCODE, 
        SPEC, 
        UNIT, 
        EXPLUCODE, 
        HJPRICE, 
        WJPRICE, 
        PRICE, 
        JTAXRATE, 
        YLPERCENT, 
        YLCOUNT, 
        YLHCOST, 
        YLWCOST, 
        YLTOTAL, 
        REMARK, 
        JTAXCALTYPE
    )
    <foreach collection="bodys" item="body" separator="union all">
        SELECT
          #{body.billNo,jdbcType=VARCHAR},
          #{body.serialNo,jdbcType=NUMERIC},
          #{body.pluId,jdbcType=NUMERIC},
          #{body.pluCode,jdbcType=VARCHAR},
          #{body.pluName,jdbcType=VARCHAR},
          #{body.barCode,jdbcType=VARCHAR},
          #{body.spec,jdbcType=VARCHAR},
          #{body.unit,jdbcType=VARCHAR},
          #{body.exPluCode,jdbcType=VARCHAR},
          #{body.hjPrice,jdbcType=NUMERIC},
          #{body.wjPrice,jdbcType=NUMERIC},
          #{body.price,jdbcType=NUMERIC},
          #{body.jTaxRate,jdbcType=NUMERIC},
          #{body.ylPercent,jdbcType=NUMERIC},
          #{body.ylCount,jdbcType=NUMERIC},
          #{body.ylhCost,jdbcType=NUMERIC},
          #{body.ylwCost,jdbcType=NUMERIC},
          #{body.ylTotal,jdbcType=NUMERIC},
          #{body.remark,jdbcType=VARCHAR},
          #{body.jTaxcalType,jdbcType=VARCHAR}
        FROM DUAL
    </foreach>
  </insert>
  
  <!-- 插入成品数据 -->
  <insert id="insertJgCps">
    INSERT INTO TFRSJGCP
    (
        BILLNO, 
        SERIALNO, 
        PLUID, 
        PLUCODE, 
        PLUNAME, 
        BARCODE, 
        SPEC, 
        UNIT, 
        EXPLUCODE, 
        HJPRICE, 
        WJPRICE, 
        PRICE, 
        JTAXRATE, 
        CPPERCENT, 
        CPCOUNT, 
        CPHCOST, 
        CPWCOST, 
        CPTOTAL, 
        REMARK, 
        JTAXCALTYPE, 
        FPPERCENT
    )
    <foreach collection="bodys" item="body" separator="union all">
        SELECT
          #{body.billNo,jdbcType=VARCHAR},
          #{body.serialNo,jdbcType=NUMERIC},
          #{body.pluId,jdbcType=NUMERIC},
          #{body.pluCode,jdbcType=VARCHAR},
          #{body.pluName,jdbcType=VARCHAR},
          #{body.barCode,jdbcType=VARCHAR},
          #{body.spec,jdbcType=VARCHAR},
          #{body.unit,jdbcType=VARCHAR},
          #{body.exPluCode,jdbcType=VARCHAR},
          #{body.hjPrice,jdbcType=NUMERIC},
          #{body.wjPrice,jdbcType=NUMERIC},
          #{body.price,jdbcType=NUMERIC},
          #{body.jTaxRate,jdbcType=NUMERIC},
          #{body.cpPercent,jdbcType=NUMERIC},
          #{body.cpCount,jdbcType=NUMERIC},
          #{body.cphCost,jdbcType=NUMERIC},
          #{body.cpwCost,jdbcType=NUMERIC},
          #{body.cpTotal,jdbcType=NUMERIC},
          #{body.remark,jdbcType=VARCHAR},
          #{body.jTaxcalType,jdbcType=VARCHAR},
          #{body.fpPercent,jdbcType=NUMERIC}
        FROM DUAL
    </foreach>
  </insert>
  
  <!-- 通过单号获取加工单主表 -->
  <select id="getJgHead" resultMap="BaseResultMap">
     Select Distinct t.BILLNO,
                t.USERID,
                t.USERCODE,
                t.USERNAME,
                t.JZDATE,
                t.JZRID,
                t.JZRCODE,
                t.JZRNAME,
                t.YWTYPE,
                t.YWIOTYPE,
                t.ORGCODE,
                t.ORGNAME,
                t.DEPID,
                t.DEPCODE,
                t.DEPNAME,
                t.GYCODE, 
                t.GYNAME, 
                t.YLCOUNT, 
                t.YLHCOST, 
                t.YLWCOST, 
                t.YLTOTAL, 
                t.CPCOUNT, 
                t.CPHCOST, 
                t.CPWCOST, 
                t.CPTOTAL, 
                t.FLCOST, 
                t.REMARK, 
                t.DATASTATUS,
                t.CKCODE, 
                t.CKNAME
    From TFRSJGHEAD t Where t.BILLNO = #{billNo,jdbcType=VARCHAR}
  </select>
  
  <!-- 通过单号获取加工单原料数据 -->
  <select id="getJgYls" resultMap="BaseResultMapYl">
    Select Distinct t.BILLNO,
        t.SERIALNO, 
        t.PLUID, 
        t.PLUCODE, 
        t.PLUNAME, 
        t.BARCODE, 
        t.SPEC, 
        t.UNIT, 
        t.EXPLUCODE, 
        t.EXPLUNAME, 
        t.HJPRICE, 
        t.WJPRICE, 
        t.PRICE, 
        t.JTAXRATE, 
        t.YLPERCENT, 
        t.YLCOUNT, 
        t.YLHCOST, 
        t.YLWCOST, 
        t.YLTOTAL, 
        t.REMARK, 
        t.JTAXCALTYPE
    From TFRSJGYL t Where t.BILLNO = #{billNo,jdbcType=VARCHAR}
  </select>
  
  <!-- 通过单号获取加工单成品数据 -->
  <select id="getJgCps" resultMap="BaseResultMapCp">
    Select Distinct t.BILLNO,
        t.SERIALNO, 
        t.PLUID, 
        t.PLUCODE, 
        t.PLUNAME, 
        t.BARCODE, 
        t.SPEC, 
        t.UNIT, 
        t.EXPLUCODE, 
        t.EXPLUNAME, 
        t.HJPRICE, 
        t.WJPRICE, 
        t.PRICE, 
        t.JTAXRATE, 
        t.CPPERCENT, 
        t.CPCOUNT, 
        t.CPHCOST, 
        t.CPWCOST, 
        t.CPTOTAL, 
        t.REMARK, 
        t.JTAXCALTYPE, 
        t.FPPERCENT
    From TFRSJGCP t Where t.BILLNO = #{billNo,jdbcType=VARCHAR}
  </select>
  
  <!-- 删除加工主表 -->
  <delete id="delJgHead" parameterType="java.lang.String">
    DELETE FROM TFRSJGHEAD WHERE BILLNO = #{billNo,jdbcType=VARCHAR}
  </delete>
  
  <!-- 删除加工原料 -->
  <delete id="delJgYls" parameterType="java.lang.String">
    DELETE FROM TFRSJGYL WHERE BILLNO = #{billNo,jdbcType=VARCHAR}
  </delete>
  
  <!-- 删除加工成品 -->
  <delete id="delJgCps" parameterType="java.lang.String">
    DELETE FROM TFRSJGCP WHERE BILLNO = #{billNo,jdbcType=VARCHAR}
  </delete>
  
  <!-- 获取多经营部门商品数据 -->
  <select id="getMultiSkus" resultMap="BaseResultMapSkuEx">
    Select Distinct t.PLUID,t.PLUCODE,t.PLUNAME,t.PLUENAME,t.PLUABBRNAME,t.PLUMN,t.BARCODE,t.UNIT,t.SPEC,t.PLUWEIGHT,
    t.PLUHEIGHT,t.PLULONG,t.PLUWIDTH,t.ISMULPACKET,t.ORGCODE,t.ORGNAME,t.CGYID,t.CGYCODE,t.CGYNAME,t.CARGONO,
    t.PRODUCE,t.GRADE,t.QUALITY,t.BZDAYS,t.CLSID,t.BRANDCODE,t.JTAXCALTYPE,t.WJPRICE,t.HJPRICE,t.JTAXRATE,
    t.PRICE,t.XTAXRATE,t.ISWEIGHT,t.ISCOUTQTY,t.ISKC,t.ISCURRDAY,t.JHBFBZDAYS,t.PSBFBZDAYS,t.CXINFO,t.YWSTATUS,t.LRDATE,
    t.LRUSERCODE,t.LRUSERNAME,t.ZXDATE,t.ZXUSERCODE,t.ZXUSERNAME,t.UDP1,t.UDP2,t.UDP3,t.UDP4,t.PLUCLS,
    t.PLUMODEL,t.MATERIALCODE,t.LRORGCODE,t.LRORGNAME,t.DATASRC,t.MINTHDAYS,t.MAXTHDAYS,t.ISONLINE,t.LINEDATE,t.PLUDESC,
    t4.EXPLUCODE,t4.HCOST,t4.WCOST,t4.PLUTYPE,t4.PACKQTY
    From TSKUPLU t,TSKUPLUEX t2,TSKUPLUOTHERDEPT t3,TSTKLSKC t4
    Where t.ISACTIVE = '1' And t.ISKC='1' 
    And t.PLUID = t2.PLUID And t.ORGCODE = t2.ORGCODE And t2.IsSale = '1'
    And t.PLUID = t3.PLUID And t3.IsSale = '1'
    And t.PLUID = t4.PLUID And t.ORGCODE = t4.ORGCODE
    And t3.DEPId = t4.DEPId
    And t3.ORGCODE = #{orgCode,jdbcType=VARCHAR} 
    And t3.DEPId = #{depId,jdbcType=NUMERIC} 
    And t4.CKCODE = #{ckCode,jdbcType=VARCHAR}
  </select>
  
  <!-- 获取商品领用及报损商品 -->
  <select id="getLyAndBsSkus" resultMap="BaseResultMapSkuEx">
    Select Distinct t.PLUID,t.PLUCODE,t.PLUNAME,t.PLUENAME,t.PLUABBRNAME,t.PLUMN,t.BARCODE,t.UNIT,t.SPEC,t.PLUWEIGHT,
    t.PLUHEIGHT,t.PLULONG,t.PLUWIDTH,t.ISMULPACKET,t.ORGCODE,t.ORGNAME,t.CGYID,t.CGYCODE,t.CGYNAME,t.CARGONO,
    t.PRODUCE,t.GRADE,t.QUALITY,t.BZDAYS,t.CLSID,t.BRANDCODE,t.JTAXCALTYPE,t.WJPRICE,t.HJPRICE,t.JTAXRATE,
    t.PRICE,t.XTAXRATE,t.ISWEIGHT,t.ISCOUTQTY,t.ISKC,t.ISCURRDAY,t.JHBFBZDAYS,t.PSBFBZDAYS,t.CXINFO,t.YWSTATUS,t.LRDATE,
    t.LRUSERCODE,t.LRUSERNAME,t.ZXDATE,t.ZXUSERCODE,t.ZXUSERNAME,t.UDP1,t.UDP2,t.UDP3,t.UDP4,t.PLUCLS,
    t.PLUMODEL,t.MATERIALCODE,t.LRORGCODE,t.LRORGNAME,t.DATASRC,t.MINTHDAYS,t.MAXTHDAYS,t.ISONLINE,t.LINEDATE,t.PLUDESC,
    t3.EXPLUCODE,t3.HCOST,t3.WCOST,t3.PLUTYPE,t3.PACKQTY
    From TSKUPLU t,TSKUPLUEX t2,TSTKLSKC t3,tSkuLyBsSetOrg t4,tSkuLyBsSetHead t5,tSkuLyBsSetBody t6
    Where t.ISACTIVE = '1' And t.ISKC='1' 
    And t.PLUID = t2.PLUID And t.ORGCODE = t2.ORGCODE And t2.IsSale = '1'
    And t.PLUID = t3.PLUID And t.ORGCODE = t3.ORGCODE
    And t.PLUID = t6.PLUID And t.ORGCODE = t4.usorgcode
    And t5.ctrltype = '2'
    And t4.procode = t5.procode And t5.procode = t6.procode
    And t4.usorgcode = #{orgCode,jdbcType=VARCHAR} 
    And t2.depid = #{depId,jdbcType=NUMERIC} 
    And t3.CKCODE = #{ckCode,jdbcType=VARCHAR}
  </select>
  
  <!-- 获取加工工艺数据 -->
  <select id="getJgGys" resultMap="BaseResultMapGy">
    Select Distinct 
        t.GYCODE, 
        t.GYNAME, 
        t.ORGCODE, 
        t.ORGCNAME, 
        t.DEPTID, 
        t.DEPCODE, 
        t.DEPNAME, 
        t.FLCOST, 
        t.REMARK, 
        t.USESTATUS
     From TFRSGY t Where t.ORGCODE = #{orgCode,jdbcType=VARCHAR} And t.DEPCODE = #{depCode,jdbcType=VARCHAR}
     And t.USESTATUS = '2'
  </select>
  
  <!-- 调用存储过程进行加工单据记账 -->
    <select id="execJgAccountProcedure" statementType="CALLABLE" parameterType="java.util.HashMap">
    <![CDATA[
     {
       CALL sFrs_JgBill_Account
       (
         #{ps_BillNo,mode=IN,jdbcType=VARCHAR}, to_date(#{pd_Date,jdbcType=DATE},'yyyy-MM-dd HH24:mi:ss'), #{pf_UserID,mode=IN,jdbcType=NUMERIC}, 
         #{ps_UserCode,mode=IN,jdbcType=VARCHAR}, #{ps_UserName,mode=IN,jdbcType=VARCHAR},  
         #{pi_Result,mode=OUT,jdbcType=NUMERIC}, #{ps_Message,mode=OUT,jdbcType=VARCHAR}, #{ps_ClType,mode=IN,jdbcType=VARCHAR}
       )
     }
    ]]>
  </select>
</mapper>